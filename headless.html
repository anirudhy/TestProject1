<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birthday Message (Headless)</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 12px;
            color: #333;
            padding: 10px;
        }
    </style>
</head>
<body>
    <div id="status">Writing birthday message...</div>
    <script>
        // Headless add-in - auto-writes birthday message then closes
        Office.onReady((info) => {
            if (info.host === Office.HostType.Word) {
                writeBirthdayMessageAndClose();
            }
        });

        function writeBirthdayMessageAndClose() {
            const birthdayText = `üéâüéÇ HAPPY BIRTHDAY! üéÇüéâ

Wishing you a day filled with happiness and a year filled with joy!

May all your dreams and wishes come true on this special day.

Have a wonderful birthday celebration!

With love and best wishes,
Your Office Add-in`;

            Office.context.document.setSelectedDataAsync(
                birthdayText,
                { coercionType: Office.CoercionType.Text },
                (result) => {
                    if (result.status === Office.AsyncResultStatus.Succeeded) {
                        document.getElementById('status').textContent = '‚úÖ Birthday message written!';

                        // Auto-enable auto-open for next time
                        Office.context.document.settings.set('Office.AutoShowTaskpaneWithDocument', true);
                        Office.context.document.settings.saveAsync();

                        // Close the task pane after 100ms
                        setTimeout(() => {
                            // Request to close the task pane
                            Office.context.ui.closeContainer();
                        }, 100);
                    } else {
                        document.getElementById('status').textContent = '‚ùå Error: ' + result.error.message;
                    }
                }
            );
        }
    </script>
</body>
</html>
